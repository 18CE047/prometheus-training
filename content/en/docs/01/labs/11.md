---
title: "1.1 Tasks: Setup"
weight: 1
sectionnumber: 1
---

### Task 1

* Download the latest version of [node exporter](https://github.com/prometheus/node_exporter/releases) into your working directory (`~/prometheus`), extract it and run it
* Configure Prometheus to scrape the metrics from `node_exporter`

### Task 2 (advanced)

* Use a metric relabel configuration to drop the metric `net_conntrack_dialer_conn_failed_total`

## Solutions

{{% details title="Task 1" %}}

```bash
cd ~/prometheus
curl -L -O https://github.com/prometheus/node_exporter/releases/download/v1.0.1/node_exporter-1.0.1.linux-amd64.tar.gz
tar fvxz node_exporter-1.0.1.linux-amd64.tar.gz
./node_exporter-1.0.1.linux-amd64/node_exporter &
```

The Prometheus configuration part can be solved by either using a static configuration **or** by using the file service discovery mechanism:

### Option 1: Static config

`prometheus.yml`
```yaml
global:
  scrape_interval:     15s
  evaluation_interval: 15s

alerting:
  alertmanagers:
  - static_configs:
    - targets:

rule_files:

scrape_configs:
  - job_name: 'prometheus'
    static_configs:
    - targets: ['localhost:9090']

  - job_name: 'node_exporter'
    static_configs:
    - targets: ['localhost:9100']
```

### Option 2: File service discovery

`prometheus.yml`

```yaml
global:
  scrape_interval:     15s
  evaluation_interval: 15s

alerting:
  alertmanagers:
  - static_configs:
    - targets:

rule_files:

scrape_configs:
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  - job_name: node_exporter
    file_sd_configs:
      - files:
        - node_exporter_targets.yml

```

`node_exporter_targets.yml`

```yaml
- targets:
    - 127.0.0.1:9100
```

### Reload Prometheus

```bash
killall -HUP prometheus
```

### Verify in the web UI

Check that the new target shows up in the web UI: <http://localhost:9090/targets>.

{{% /details %}}


{{% details title="Task 2" %}}
```yaml
- job_name: 'node_exporter'
  static_configs:
    - targets: ['localhost:9100']
  metric_relabel_configs:
    - source_labels: [ __name__ ]
      regex: 'net_conntrack_dialer_conn_failed_total'
      action: drop
```
{{% /details %}}
